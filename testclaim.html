<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FlappyBird Reward</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body style="background:#111; color:white; text-align:center; padding:20px;">

  <h2>üéÆ FlappyBird Reward (Sepolia)</h2>

  <!-- Connect Button -->
  <button id="connectWalletBtn" style="padding:10px 20px; margin:10px; background:#2d72d9; color:white; border:none; border-radius:6px; cursor:pointer;">
    Connect Wallet
  </button>
  <p id="walletInfo"></p>

  <!-- Claim Button -->
  <button id="claimBtn" style="padding:10px 20px; margin:10px; background:green; color:white; border:none; border-radius:6px; cursor:pointer;" disabled>
    Claim Reward
  </button>
  <p id="status"></p>

  <script>
    const connectBtn = document.getElementById("connectWalletBtn");
    const claimBtn = document.getElementById("claimBtn");
    const walletInfo = document.getElementById("walletInfo");
    const status = document.getElementById("status");

    let provider, signer, contract;

    // === Kontrak Reward ===
    const CONTRACT_ADDRESS = "0x21D994934c35310e3C356Baac7d723159cA28Cab";
    const CONTRACT_ABI = [
      // sesuaikan ABI claim function
      "function claim() public returns (bool)"
    ];

    // Connect Wallet
    async function connectWallet() {
      if (!window.ethereum) {
        alert("Install Metamask / WalletConnect dulu!");
        return;
      }
      provider = new ethers.providers.Web3Provider(window.ethereum);
      await provider.send("eth_requestAccounts", []);
      signer = provider.getSigner();

      const account = await signer.getAddress();
      walletInfo.innerText = "‚úÖ Connected: " + account;

      connectBtn.innerText = "Connected";
      connectBtn.disabled = true;
      connectBtn.style.background = "gray";

      claimBtn.disabled = false;

      // init kontrak
      contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);

      // optional: cek jaringan ‚Üí Sepolia
      const { chainId } = await provider.getNetwork();
      if (chainId !== 11155111) {
        alert("‚õî Please switch to Sepolia network in your wallet!");
      }
    }

    // Claim Reward
    async function claimReward() {
      try {
        status.innerText = "‚è≥ Sending claim transaction...";
        const tx = await contract.claim();
        await tx.wait();
        status.innerText = "‚úÖ Reward claimed! Tx Hash: " + tx.hash;
      } catch (err) {
        console.error(err);
        status.innerText = "‚ùå Error: " + (err.message || err);
      }
    }

    connectBtn.onclick = connectWallet;
    claimBtn.onclick = claimReward;
  </script>
</body>
</html>